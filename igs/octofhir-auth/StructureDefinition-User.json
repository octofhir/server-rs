{
  "resourceType": "StructureDefinition",
  "id": "User",
  "url": "http://octofhir.io/StructureDefinition/User",
  "name": "User",
  "title": "User Account",
  "status": "active",
  "fhirVersion": "4.0.1",
  "kind": "logical",
  "abstract": false,
  "type": "User",
  "baseDefinition": "http://hl7.org/fhir/StructureDefinition/DomainResource",
  "derivation": "specialization",
  "description": "A user account for authentication. Can be linked to FHIR Practitioner, Patient, or Person resources.",
  "differential": {
    "element": [
      {
        "id": "User",
        "path": "User",
        "short": "User account",
        "definition": "Defines a user account with credentials and profile information."
      },
      {
        "id": "User.username",
        "path": "User.username",
        "short": "Username for login",
        "definition": "Unique username for authentication",
        "min": 1,
        "max": "1",
        "type": [{ "code": "string" }]
      },
      {
        "id": "User.name",
        "path": "User.name",
        "short": "Display name",
        "definition": "Human-readable display name for the user",
        "min": 0,
        "max": "1",
        "type": [{ "code": "string" }]
      },
      {
        "id": "User.password",
        "path": "User.password",
        "short": "Password (write-only)",
        "definition": "User password for authentication. Only used during create/update, never returned in responses.",
        "min": 0,
        "max": "1",
        "type": [{ "code": "string" }]
      },
      {
        "id": "User.passwordHash",
        "path": "User.passwordHash",
        "short": "Hashed password",
        "definition": "BCrypt-hashed password (internal use only)",
        "min": 0,
        "max": "1",
        "type": [{ "code": "string" }]
      },
      {
        "id": "User.email",
        "path": "User.email",
        "short": "Email address",
        "definition": "User's email address",
        "min": 0,
        "max": "1",
        "type": [{ "code": "string" }]
      },
      {
        "id": "User.fhirUser",
        "path": "User.fhirUser",
        "short": "Linked FHIR resource",
        "definition": "Reference to the FHIR resource this user represents (Practitioner, Patient, Person, or RelatedPerson)",
        "comment": "Used for SMART on FHIR fhirUser claim",
        "min": 0,
        "max": "1",
        "type": [
          {
            "code": "Reference",
            "targetProfile": [
              "http://hl7.org/fhir/StructureDefinition/Practitioner",
              "http://hl7.org/fhir/StructureDefinition/Patient",
              "http://hl7.org/fhir/StructureDefinition/Person",
              "http://hl7.org/fhir/StructureDefinition/RelatedPerson"
            ]
          }
        ]
      },
      {
        "id": "User.active",
        "path": "User.active",
        "short": "Is account active",
        "definition": "Whether this user account is currently active",
        "min": 1,
        "max": "1",
        "type": [{ "code": "boolean" }]
      },
      {
        "id": "User.mfaEnabled",
        "path": "User.mfaEnabled",
        "short": "MFA enabled",
        "definition": "Whether multi-factor authentication is enabled for this user",
        "min": 0,
        "max": "1",
        "type": [{ "code": "boolean" }]
      },
      {
        "id": "User.roles",
        "path": "User.roles",
        "short": "User roles",
        "definition": "Roles assigned to this user for authorization",
        "min": 0,
        "max": "*",
        "type": [{ "code": "string" }]
      },
      {
        "id": "User.attributes",
        "path": "User.attributes",
        "short": "Custom attributes",
        "definition": "Additional key-value attributes for policy evaluation and custom data",
        "min": 0,
        "max": "1",
        "type": [{ "code": "string" }],
        "comment": "Stored as JSON object. Used in access policies for fine-grained authorization."
      },
      {
        "id": "User.createdAt",
        "path": "User.createdAt",
        "short": "Creation timestamp",
        "definition": "When the user account was created",
        "min": 0,
        "max": "1",
        "type": [{ "code": "instant" }]
      },
      {
        "id": "User.updatedAt",
        "path": "User.updatedAt",
        "short": "Last update timestamp",
        "definition": "When the user account was last updated",
        "min": 0,
        "max": "1",
        "type": [{ "code": "instant" }]
      },
      {
        "id": "User.lastLoginAt",
        "path": "User.lastLoginAt",
        "short": "Last login timestamp",
        "definition": "When the user last successfully authenticated",
        "min": 0,
        "max": "1",
        "type": [{ "code": "instant" }]
      }
    ]
  }
}
